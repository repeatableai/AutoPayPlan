import React from 'react';
import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';
import { MaterialCommunityIcons, Ionicons, Entypo } from '@expo/vector-icons';
import Svg, { Path } from 'react-native-svg';
import type { MainTabParamList } from '@types/navigation';
import { colors } from '@theme';

// Import screens and navigators
import { DashboardNavigator } from './DashboardNavigator';
import { PlanNavigator } from './PlanNavigator';
import { MoreNavigator } from './MoreNavigator';
import { InsuranceScreen } from '@screens/insurance/InsuranceScreen';
import { ServiceScreen } from '@screens/service/ServiceScreen';

const Tab = createBottomTabNavigator<MainTabParamList>();

// Custom AutoPayPlan icon - shield with dollar sign/coin
const AutoPayPlanIcon = ({ focused }: { focused: boolean }) => {
  const color = focused ? '#0066FF' : '#9E9E9E';
  return (
    <Svg width="28" height="28" viewBox="27 0 24 22" fill="none">
      <Path
        d="M47.1276 8.9888C46.5671 4.84412 43.2197 1.56324 38.9961 1.00932C38.3053 0.920233 37.7368 1.4819 37.7368 2.16751V8.98493C37.7368 9.67054 38.3013 10.2245 39 10.2245H41.1237C42.3237 9.44201 43.7645 8.98493 45.3158 8.98493C45.9434 8.98493 46.5513 9.05853 47.1355 9.20185C47.1395 9.13212 47.1395 9.0624 47.1276 8.9888ZM36.4737 20.7605C37.3263 20.7605 38.1513 20.6481 38.9368 20.4428C38.175 19.2847 37.7368 17.9018 37.7368 16.4221C37.7368 14.803 38.2658 13.3039 39.1579 12.0838H36.7895C36.2645 12.0838 35.8421 11.6693 35.8421 11.1541V3.51163C35.8421 2.79502 35.2224 2.22174 34.5079 2.36893C30.2171 3.25597 27 6.99006 27 11.464C27 16.5964 31.2434 20.7605 36.4737 20.7605ZM51 16.4221C51 14.9428 50.4011 13.524 49.3351 12.478C48.2691 11.4319 46.8233 10.8442 45.3158 10.8442C43.8082 10.8442 42.3624 11.4319 41.2964 12.478C40.2304 13.524 39.6316 14.9428 39.6316 16.4221C39.6316 17.9015 40.2304 19.3202 41.2964 20.3663C42.3624 21.4123 43.8082 22 45.3158 22C46.8233 22 48.2691 21.4123 49.3351 20.3663C50.4011 19.3202 51 17.9015 51 16.4221ZM44.6842 13.3233C44.6842 12.9824 44.9684 12.7035 45.3158 12.7035C45.6632 12.7035 45.9474 12.9824 45.9474 13.3233V13.6332H46.5789C46.9263 13.6332 47.2105 13.9121 47.2105 14.2529C47.2105 14.5938 46.9263 14.8727 46.5789 14.8727H44.7711C44.55 14.8727 44.3684 15.0509 44.3684 15.2678C44.3684 15.4576 44.5066 15.6203 44.6961 15.6552L46.4724 15.9728C47.2618 16.1122 47.8382 16.7901 47.8382 17.5803C47.8382 18.4828 47.0921 19.2149 46.1724 19.2149H45.9434V19.5248C45.9434 19.8657 45.6592 20.1446 45.3118 20.1446C44.9645 20.1446 44.6803 19.8657 44.6803 19.5248V19.2149H44.0487C43.7013 19.2149 43.4171 18.936 43.4171 18.5952C43.4171 18.2543 43.7013 17.9754 44.0487 17.9754H46.1724C46.3934 17.9754 46.575 17.7972 46.575 17.5803C46.575 17.3905 46.4368 17.2278 46.2474 17.1929L44.4711 16.8753C43.6816 16.7359 43.1053 16.058 43.1053 15.2678C43.1053 14.3924 43.8039 13.6797 44.6842 13.637V13.3233Z"
        fill={color}
      />
    </Svg>
  );
};

// Custom Dashboard icon - colorful pinwheel flower SVG
const DashboardIcon = ({ focused }: { focused: boolean }) => {
  const gray = '#9E9E9E';
  return (
    <Svg width="28" height="28" viewBox="26 0 24 22" fill="none">
      {/* Red petal - top left */}
      <Path
        d="M33.3892 5.94925C33.2932 5.95144 33.1964 5.9866 33.1187 6.0569C32.775 6.36742 32.4518 6.70869 32.1535 7.07999C32.0611 7.19497 31.9123 7.2499 31.7665 7.22573L28.0828 6.61422C27.8805 6.58053 27.6841 6.70137 27.6218 6.8969L26.4191 10.6971C26.3575 10.8926 26.4484 11.1035 26.6338 11.1929L30.0038 12.8113C30.1365 12.8751 30.2266 13.0047 30.2361 13.1512C30.2647 13.5928 30.3263 14.0314 30.4208 14.4635C30.4729 14.7045 30.7199 14.8487 30.9544 14.7718L34.4849 13.6074C34.6726 13.5459 34.7906 13.3591 34.7642 13.1629C34.622 12.1149 34.8631 11.0127 35.5279 10.0877C35.6415 9.92956 35.7639 9.78162 35.8936 9.64394C36.0292 9.5004 36.0409 9.2807 35.9244 9.12105L33.7307 6.11842C33.6479 6.00564 33.5211 5.94778 33.3921 5.94925H33.3892Z"
        fill={focused ? '#F35437' : gray}
      />
      {/* Purple petal - center left */}
      <Path
        d="M34.9232 14.4031C34.8829 14.4038 34.8426 14.4104 34.8023 14.4236L31.2718 15.5888C31.0387 15.6657 30.9251 15.9271 31.0255 16.1512C31.2117 16.5665 31.4301 16.9685 31.6807 17.353C31.7614 17.4768 31.7672 17.6342 31.6991 17.7653L29.973 21.0733C29.8785 21.2549 29.932 21.479 30.0983 21.5984L33.3401 23.9222C33.5072 24.0415 33.7366 24.0203 33.8788 23.8724L36.4616 21.178C36.5635 21.0719 36.7152 21.0272 36.8581 21.0631C37.3038 21.1773 37.7552 21.2549 38.2075 21.2982C38.4515 21.3216 38.6633 21.1297 38.6611 20.8844L38.634 17.1692C38.6325 16.9707 38.4896 16.8015 38.2939 16.7671C37.6827 16.6587 37.0868 16.4156 36.5496 16.0311C36.0123 15.6466 35.5909 15.1596 35.2926 14.6162C35.2178 14.48 35.0749 14.4009 34.9261 14.4024H34.9232"
        fill={focused ? '#A44BAB' : gray}
      />
      {/* Yellow/Orange petal - center right */}
      <Path
        d="M43.1532 14.4239C43.0095 14.4268 42.8739 14.5052 42.8014 14.637C42.7193 14.7864 42.6269 14.9329 42.525 15.0757C41.861 16.0006 40.8935 16.5828 39.8543 16.7835C39.66 16.8209 39.5208 16.993 39.523 17.19L39.5501 20.9044C39.5516 21.1505 39.767 21.3387 40.0111 21.3109C40.478 21.2589 40.9397 21.1695 41.3927 21.0443C41.5349 21.0048 41.6873 21.0472 41.7914 21.1512L44.4292 23.7987C44.5743 23.9437 44.8037 23.9605 44.9686 23.8382L48.1649 21.4522C48.3298 21.3292 48.3782 21.1044 48.28 20.9242L46.4902 17.6506C46.4198 17.521 46.422 17.3628 46.5004 17.2376C46.7181 16.8904 46.9087 16.5323 47.0729 16.1669C47.1733 15.9428 47.0597 15.6806 46.8259 15.6037L43.291 14.4444C43.247 14.4297 43.2015 14.4232 43.1568 14.4239H43.1539"
        fill={focused ? '#FCB52C' : gray}
      />
      {/* Green petal - top right */}
      <Path
        d="M43.4626 13.4434C43.4956 13.4661 43.533 13.4844 43.5726 13.4968L47.1214 14.6034C47.3559 14.6767 47.6007 14.5302 47.6498 14.29C47.7407 13.8447 47.7972 13.3907 47.8177 12.9315C47.8243 12.7843 47.9115 12.6524 48.0427 12.5858L51.3738 10.9007C51.5571 10.8084 51.6436 10.5953 51.5783 10.4005L50.2964 6.62522C50.2305 6.43115 50.0318 6.31471 49.8296 6.35279L46.1598 7.04047C46.0147 7.06756 45.8652 7.01557 45.7706 6.90278C45.4752 6.55052 45.1535 6.22463 44.8105 5.92656C44.6258 5.76545 44.3421 5.7984 44.2007 5.99833L42.0583 9.03465C41.944 9.1965 41.9616 9.41767 42.1008 9.55974C42.5347 10.0035 42.8777 10.5477 43.0903 11.1731C43.3028 11.7985 43.3622 12.4393 43.2874 13.0545C43.2691 13.209 43.3388 13.3562 43.4612 13.4412L43.4641 13.4427"
        fill={focused ? '#79B544' : gray}
      />
      {/* Blue petal - top center */}
      <Path
        d="M41.2624 8.65709C41.2946 8.63292 41.3239 8.60363 41.3489 8.56994L43.5366 5.56658C43.681 5.36811 43.6209 5.08982 43.4091 4.96605C43.0155 4.73756 42.6036 4.53836 42.1749 4.37139C42.0371 4.31792 41.9403 4.19342 41.9191 4.04696L41.3906 0.353724C41.3613 0.150864 41.1876 0 40.9824 0L36.9931 0.0014647C36.7879 0.0014647 36.6134 0.152328 36.5848 0.355921L36.0593 4.04988C36.0388 4.19562 35.9413 4.32085 35.8043 4.37432C35.3755 4.54129 34.9636 4.74049 34.5707 4.96971C34.3589 5.09348 34.2988 5.37177 34.4432 5.57024L36.6339 8.57213C36.7512 8.73252 36.966 8.78598 37.1448 8.7003C37.704 8.43226 38.3307 8.28212 38.9918 8.28212C39.6529 8.28212 40.2788 8.43152 40.8387 8.69883C40.9795 8.76621 41.1414 8.74717 41.2609 8.65855L41.2631 8.65635"
        fill={focused ? '#0098E6' : gray}
      />
    </Svg>
  );
};

export const MainNavigator = () => {
  return (
    <Tab.Navigator
      screenOptions={{
        headerShown: false,
        tabBarActiveTintColor: colors.primary.blue,
        tabBarInactiveTintColor: '#636566',
        tabBarStyle: {
          backgroundColor: colors.background.white,
          borderTopColor: '#E0E0E0',
          borderTopWidth: 1,
          paddingBottom: 24,
          paddingTop: 12,
          height: 88,
        },
        tabBarLabelStyle: {
          fontSize: 11,
          fontWeight: '500',
          marginTop: 4,
        },
      }}
    >
      <Tab.Screen
        name="Dashboard"
        component={DashboardNavigator}
        options={{
          tabBarLabel: 'Dashboard',
          tabBarIcon: ({ focused }) => <DashboardIcon focused={focused} />,
        }}
      />
      <Tab.Screen
        name="AutoPayPlan"
        component={PlanNavigator}
        options={{
          tabBarLabel: 'AutoPayPlan',
          tabBarIcon: ({ focused }) => <AutoPayPlanIcon focused={focused} />,
        }}
      />
      <Tab.Screen
        name="Insurance"
        component={InsuranceScreen}
        options={{
          tabBarLabel: 'Insurance',
          tabBarIcon: ({ color, size }) => (
            <MaterialCommunityIcons name="shield-car" size={26} color={color} />
          ),
        }}
      />
      <Tab.Screen
        name="Service"
        component={ServiceScreen}
        options={{
          tabBarLabel: 'Service',
          tabBarIcon: ({ color, size }) => (
            <Ionicons name="car" size={26} color={color} />
          ),
        }}
      />
      <Tab.Screen
        name="More"
        component={MoreNavigator}
        options={{
          tabBarLabel: 'More',
          tabBarIcon: ({ color, size }) => (
            <Entypo name="dots-three-vertical" size={22} color={color} />
          ),
        }}
      />
    </Tab.Navigator>
  );
};
